<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Green Farmer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#14532d;
  font-family:Arial;
  color:#ecfdf5;
  text-align:center;
}
canvas{
  background:linear-gradient(#4ade80,#166534);
  display:block;
  margin:auto;
  border:3px solid #064e3b;
}
.hud{
  display:flex;
  justify-content:space-around;
  padding:8px;
  background:#064e3b;
}
button{
  padding:12px 18px;
  margin:6px;
  font-size:16px;
  border:none;
  border-radius:8px;
  background:#22c55e;
  font-weight:bold;
  cursor:pointer;
}
.controls{
  display:flex;
  justify-content:center;
}
.energy-bar{
  width:200px;
  height:20px;
  border:2px solid #fbbf24;
  margin:4px auto;
  background:#064e3b;
  border-radius:6px;
  overflow:hidden;
}
.energy-fill{
  height:100%;
  background:#fbbf24;
  width:100%;
}
</style>
</head>

<body>

<h2>ğŸŒ± GREEN FARMER</h2>

<div class="hud">
  <div>â¤ï¸ <span id="life">3</span></div>
  <div>âš¡ <span id="energy">100</span></div>
  <div>ğŸŒ½ <span id="score">0</span></div>
  <div>ğŸ† <span id="level">1</span></div>
</div>
<div class="energy-bar">
  <div class="energy-fill" id="energy-fill"></div>
</div>

<canvas id="game" width="360" height="520"></canvas>

<div class="controls">
  <button onclick="moveLeft()">â¬…ï¸</button>
  <button onclick="harvest()">ğŸŒ¾</button>
  <button onclick="moveRight()">â¡ï¸</button>
  <button onclick="restart()" style="background:#f87171;">ğŸ”„ Restart</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let life, energy, score, level, gameOver;
let farmer, items;

function init(){
  life = 3;
  energy = 100;
  score = 0;
  level = 1;
  gameOver = false;
  farmer = { x:160, y:460, w:40, h:40, speed:6 };
  items = [];
}

init();

const types=[
  {t:"crop",c:"#22c55e",s:3},
  {t:"seed",c:"#fde047",s:1},
  {t:"weed",c:"#166534",s:-2},
  {t:"bug",c:"#dc2626",d:1},
  {t:"gold",c:"#facc15",s:6}
];

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft") moveLeft();
  if(e.key==="ArrowRight") moveRight();
  if(e.key===" ") harvest();
});

function moveLeft(){
  farmer.x-=farmer.speed;
  if(farmer.x<0) farmer.x=0;
}
function moveRight(){
  farmer.x+=farmer.speed;
  if(farmer.x+farmer.w>canvas.width)
    farmer.x=canvas.width-farmer.w;
}

function spawn(){
  const t=types[Math.floor(Math.random()*types.length)];
  items.push({
    ...t,
    x:Math.random()*(canvas.width-30),
    y:-30,
    size:30
  });
}

// circle-rectangle collision
function isColliding(circle, rect){
  const distX = Math.abs(circle.x + circle.size/2 - rect.x - rect.w/2);
  const distY = Math.abs(circle.y + circle.size/2 - rect.y - rect.h/2);

  if(distX > (rect.w/2 + circle.size/2)) return false;
  if(distY > (rect.h/2 + circle.size/2)) return false;

  if(distX <= rect.w/2) return true;
  if(distY <= rect.h/2) return true;

  const dx = distX - rect.w/2;
  const dy = distY - rect.h/2;
  return (dx*dx + dy*dy <= (circle.size/2)*(circle.size/2));
}

function harvest(){
  if(energy<=0||gameOver) return;
  energy -= 6;

  items.forEach(i=>{
    if(isColliding(i, farmer)){
      if(i.d) life-=i.d;
      else score+=i.s||0;
      i.dead=true;
    }
  });

  if(score<0) score=0;
  if(score>=level*10) level++;
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  items.forEach(i=>{
    i.y += 1.5 + level*0.4;
    ctx.fillStyle=i.c;
    ctx.beginPath();
    ctx.arc(i.x + i.size/2, i.y + i.size/2, i.size/2, 0, Math.PI*2);
    ctx.fill();

    if(i.y > canvas.height){
      if(i.t!=="weed") life--;
      i.dead=true;
    }
  });

  for(let i=items.length-1; i>=0; i--)
    if(items[i].dead) items.splice(i,1);

  // farmer
  ctx.fillStyle="#fbbf24";
  ctx.fillRect(farmer.x,farmer.y,farmer.w,farmer.h);

  // HUD
  document.getElementById("life").innerText=life;
  document.getElementById("energy").innerText=energy;
  document.getElementById("score").innerText=score;
  document.getElementById("level").innerText=level;

  // energy bar
  document.getElementById("energy-fill").style.width = energy + "%";

  if(life<=0){
    ctx.fillStyle="#f87171";
    ctx.font="28px Arial";
    ctx.fillText("GAME OVER",90,260);
    gameOver=true;
    return;
  }

  requestAnimationFrame(draw);
}

setInterval(()=>{ if(!gameOver) spawn(); },1200);
setInterval(()=>{ energy=Math.min(100,energy+2); },1000);

function restart(){
  init();
  draw();
}

draw();
</script>

</body>
</html>
